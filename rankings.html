<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Classements ATP ‚Äî MonSaaS</title>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet"/>
  <style>
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    :root{
      --bg:#050a0e;--surface:#0c1419;--surface2:#111d24;
      --border:rgba(255,255,255,0.07);--accent:#00e5a0;--accent2:#00aeff;
      --text:#e8f0f5;--muted:#5a7a8a;--radius:14px;
      --font-head:'Syne',sans-serif;--font-body:'DM Sans',sans-serif;
    }
    body{background:var(--bg);color:var(--text);font-family:var(--font-body);min-height:100vh}

    /* NAV */
    nav{position:sticky;top:0;z-index:100;display:flex;align-items:center;
      justify-content:space-between;padding:16px 5%;
      background:rgba(5,10,14,0.92);backdrop-filter:blur(20px);
      border-bottom:1px solid var(--border)}
    .nav-logo{font-family:var(--font-head);font-weight:800;font-size:1.2rem;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;text-decoration:none}
    .nav-links{display:flex;gap:24px;align-items:center}
    .nav-links a{color:var(--muted);text-decoration:none;font-size:0.88rem;font-weight:500;transition:color .2s}
    .nav-links a:hover,.nav-links a.active{color:var(--text)}
    .btn-sm{background:var(--accent);color:#000!important;padding:8px 18px;
      border-radius:50px;font-weight:700!important;font-size:0.82rem!important}

    /* HERO */
    .page-hero{padding:60px 5% 40px;border-bottom:1px solid var(--border);
      background:linear-gradient(180deg,rgba(0,229,160,0.04) 0%,transparent 100%)}
    .page-hero h1{font-family:var(--font-head);font-size:clamp(2rem,4vw,3rem);
      font-weight:800;letter-spacing:-1.5px;margin-bottom:8px}
    .page-hero h1 span{background:linear-gradient(135deg,var(--accent),var(--accent2));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .page-hero p{color:var(--muted);font-size:0.95rem}
    .live-badge{display:inline-flex;align-items:center;gap:6px;
      background:rgba(0,229,160,0.1);border:1px solid rgba(0,229,160,0.25);
      color:var(--accent);padding:4px 12px;border-radius:50px;
      font-size:0.72rem;font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:16px}
    .live-dot{width:6px;height:6px;background:var(--accent);border-radius:50%;
      animation:pulse 1.5s ease-in-out infinite}
    @keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(1.4)}}

    /* MAIN LAYOUT */
    .main{display:grid;grid-template-columns:1fr 380px;gap:24px;padding:32px 5%;align-items:start}
    @media(max-width:900px){.main{grid-template-columns:1fr}}

    /* RANKINGS TABLE */
    .card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
    .card-header{padding:20px 24px;border-bottom:1px solid var(--border);
      display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px}
    .card-header h2{font-family:var(--font-head);font-size:1rem;font-weight:700;letter-spacing:-.3px}
    .surface-tabs{display:flex;gap:4px;background:var(--surface2);border-radius:50px;padding:3px}
    .tab{padding:5px 14px;border-radius:50px;font-size:0.78rem;font-weight:600;
      cursor:pointer;transition:all .2s;border:none;background:none;color:var(--muted)}
    .tab.active{background:var(--accent);color:#000}

    /* SEARCH */
    .search-bar{padding:16px 24px;border-bottom:1px solid var(--border)}
    .search-input{width:100%;background:var(--surface2);border:1px solid var(--border);
      border-radius:50px;padding:10px 18px;color:var(--text);font-family:var(--font-body);
      font-size:0.88rem;outline:none;transition:border-color .2s}
    .search-input:focus{border-color:rgba(0,229,160,.4)}
    .search-input::placeholder{color:var(--muted)}

    /* PLAYER ROWS */
    .rankings-list{max-height:600px;overflow-y:auto}
    .rankings-list::-webkit-scrollbar{width:4px}
    .rankings-list::-webkit-scrollbar-track{background:transparent}
    .rankings-list::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px}

    .player-row{display:grid;grid-template-columns:48px 1fr auto auto;
      align-items:center;gap:12px;padding:14px 24px;
      border-bottom:1px solid var(--border);transition:background .2s;cursor:pointer}
    .player-row:hover{background:var(--surface2)}
    .player-row:last-child{border-bottom:none}
    .player-row.selected{background:rgba(0,229,160,.06);border-left:2px solid var(--accent)}

    .rank-num{font-family:var(--font-head);font-size:1rem;font-weight:800;color:var(--muted);text-align:center}
    .rank-num.top3{color:var(--accent)}
    .player-info{display:flex;align-items:center;gap:10px}
    .player-flag{font-size:1.2rem;flex-shrink:0}
    .player-name{font-weight:600;font-size:0.92rem}
    .player-country{color:var(--muted);font-size:0.75rem}
    .player-points{font-family:var(--font-head);font-weight:700;font-size:0.9rem;color:var(--accent);text-align:right}
    .player-pts-label{color:var(--muted);font-size:0.7rem;text-align:right}
    .compare-btn{background:none;border:1px solid var(--border);color:var(--muted);
      padding:5px 10px;border-radius:50px;font-size:0.72rem;font-weight:600;
      cursor:pointer;transition:all .2s;white-space:nowrap}
    .compare-btn:hover{border-color:var(--accent);color:var(--accent)}
    .compare-btn.selected-a{background:rgba(0,229,160,.15);border-color:var(--accent);color:var(--accent)}
    .compare-btn.selected-b{background:rgba(0,174,255,.15);border-color:var(--accent2);color:var(--accent2)}

    /* COMPARE PANEL */
    .compare-panel{position:sticky;top:80px}
    .compare-header{padding:20px 24px;border-bottom:1px solid var(--border)}
    .compare-header h2{font-family:var(--font-head);font-size:1rem;font-weight:700}
    .compare-header p{color:var(--muted);font-size:0.8rem;margin-top:4px}
    .compare-slots{display:grid;grid-template-columns:1fr 1fr;gap:12px;padding:16px 24px}
    .slot{background:var(--surface2);border:2px dashed var(--border);border-radius:10px;
      padding:14px;text-align:center;min-height:80px;display:flex;flex-direction:column;
      align-items:center;justify-content:center;gap:4px;transition:border-color .2s}
    .slot.filled-a{border-color:var(--accent);border-style:solid}
    .slot.filled-b{border-color:var(--accent2);border-style:solid}
    .slot-label{font-size:0.65rem;font-weight:700;letter-spacing:1px;text-transform:uppercase;color:var(--muted)}
    .slot-name{font-family:var(--font-head);font-weight:700;font-size:0.85rem;margin-top:2px}
    .slot-flag{font-size:1.4rem}
    .slot-rank{font-size:0.7rem;color:var(--muted)}
    .slot-empty-txt{color:var(--muted);font-size:0.8rem}

    .btn-compare{width:calc(100% - 48px);margin:0 24px 16px;padding:13px;border-radius:50px;
      background:var(--accent);color:#000;border:none;font-family:var(--font-body);
      font-weight:700;font-size:0.9rem;cursor:pointer;transition:all .25s}
    .btn-compare:hover{transform:translateY(-1px);box-shadow:0 8px 24px rgba(0,229,160,.3)}
    .btn-compare:disabled{opacity:.4;cursor:not-allowed;transform:none;box-shadow:none}

    /* ALGO RESULT */
    .algo-result{padding:0 24px 24px}
    .algo-score-bar{margin-bottom:20px}
    .algo-players{display:flex;justify-content:space-between;margin-bottom:8px}
    .algo-player-label{font-size:0.8rem;font-weight:600}
    .algo-player-label.a{color:var(--accent)}
    .algo-player-label.b{color:var(--accent2)}
    .bar-container{background:var(--surface2);border-radius:50px;height:8px;overflow:hidden;position:relative}
    .bar-fill{height:100%;border-radius:50px;transition:width 1s cubic-bezier(.4,0,.2,1)}
    .bar-fill.a{background:linear-gradient(90deg,var(--accent),rgba(0,229,160,.6));position:absolute;left:0}
    .bar-fill.b{background:linear-gradient(270deg,var(--accent2),rgba(0,174,255,.6));position:absolute;right:0}

    .algo-categories{display:flex;flex-direction:column;gap:10px}
    .algo-cat{background:var(--surface2);border-radius:10px;padding:12px 14px}
    .algo-cat-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
    .algo-cat-name{font-size:0.78rem;font-weight:600;color:var(--muted);letter-spacing:.5px;text-transform:uppercase}
    .algo-cat-winner{font-size:0.72rem;font-weight:700;padding:2px 8px;border-radius:50px}
    .algo-cat-winner.a{background:rgba(0,229,160,.15);color:var(--accent)}
    .algo-cat-winner.b{background:rgba(0,174,255,.15);color:var(--accent2)}
    .algo-cat-winner.tie{background:rgba(255,255,255,.08);color:var(--muted)}
    .mini-bar{background:var(--surface);border-radius:50px;height:5px;display:flex;overflow:hidden}
    .mini-fill-a{background:var(--accent);border-radius:50px 0 0 50px}
    .mini-fill-b{background:var(--accent2);border-radius:0 50px 50px 0}
    .algo-values{display:flex;justify-content:space-between;margin-top:5px}
    .algo-val{font-family:var(--font-head);font-size:0.8rem;font-weight:700}
    .algo-val.a{color:var(--accent)}
    .algo-val.b{color:var(--accent2)}

    .verdict{background:linear-gradient(135deg,rgba(0,229,160,.08),rgba(0,174,255,.06));
      border:1px solid rgba(0,229,160,.2);border-radius:10px;padding:14px;
      text-align:center;margin-top:14px}
    .verdict-label{font-size:0.72rem;font-weight:700;letter-spacing:1px;
      text-transform:uppercase;color:var(--muted);margin-bottom:4px}
    .verdict-winner{font-family:var(--font-head);font-size:1.1rem;font-weight:800;color:var(--accent)}
    .verdict-prob{font-size:0.8rem;color:var(--muted);margin-top:2px}

    .algo-placeholder{text-align:center;padding:30px 0;color:var(--muted);font-size:0.85rem}
    .algo-placeholder .icon{font-size:2rem;margin-bottom:8px}

    /* LOADING */
    .loading{display:flex;align-items:center;justify-content:center;gap:8px;
      padding:40px;color:var(--muted);font-size:0.9rem}
    .spinner{width:18px;height:18px;border:2px solid var(--border);
      border-top-color:var(--accent);border-radius:50%;
      animation:spin .8s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* UPDATE TIME */
    .update-info{padding:12px 24px;border-top:1px solid var(--border);
      color:var(--muted);font-size:0.72rem;display:flex;align-items:center;gap:6px}
  </style>
</head>
<body>

<nav>
  <a href="index.html" class="nav-logo">MON¬∑SAAS</a>
  <div class="nav-links">
    <a href="index.html">Accueil</a>
    <a href="rankings.html" class="active">Classements ATP</a>
    <a href="compare.html">Comparatif</a>
    <a href="#" class="btn-sm">Mon compte</a>
  </div>
</nav>

<div class="page-hero">
  <div class="live-badge"><div class="live-dot"></div> Donn√©es en temps r√©el</div>
  <h1>Classements <span>ATP</span> 2025</h1>
  <p>Top 100 mondial ¬∑ Mis √† jour toutes les 24h via l'API officielle ¬∑ Clique sur 2 joueurs pour les comparer</p>
</div>

<div class="main">

  <!-- CLASSEMENTS -->
  <div class="card">
    <div class="card-header">
      <h2>üèÜ Classement mondial ATP</h2>
      <div class="surface-tabs">
        <button class="tab active" onclick="filterSurface('all',this)">Tous</button>
        <button class="tab" onclick="filterSurface('hard',this)">Hard</button>
        <button class="tab" onclick="filterSurface('clay',this)">Clay</button>
        <button class="tab" onclick="filterSurface('grass',this)">Grass</button>
      </div>
    </div>
    <div class="search-bar">
      <input class="search-input" type="text" id="searchInput" placeholder="üîç Rechercher un joueur..." oninput="filterPlayers(this.value)"/>
    </div>
    <div class="rankings-list" id="rankingsList">
      <div class="loading"><div class="spinner"></div> Chargement des classements...</div>
    </div>
    <div class="update-info">
      üïê Derni√®re mise √† jour : <span id="updateTime">‚Äî</span>
    </div>
  </div>

  <!-- COMPARE PANEL -->
  <div class="compare-panel">
    <div class="card">
      <div class="compare-header">
        <h2>‚ö° Comparatif joueurs</h2>
        <p>S√©lectionne 2 joueurs dans le classement</p>
      </div>

      <div class="compare-slots">
        <div class="slot" id="slotA">
          <div class="slot-label" style="color:var(--accent)">Joueur A</div>
          <div class="slot-empty-txt">Clique "A"</div>
        </div>
        <div class="slot" id="slotB">
          <div class="slot-label" style="color:var(--accent2)">Joueur B</div>
          <div class="slot-empty-txt">Clique "B"</div>
        </div>
      </div>

      <button class="btn-compare" id="compareBtn" disabled onclick="runAlgo()">
        Lancer l'algorithme ‚Üí
      </button>

      <div class="algo-result" id="algoResult">
        <div class="algo-placeholder">
          <div class="icon">üéæ</div>
          S√©lectionne 2 joueurs pour voir l'analyse compl√®te
        </div>
      </div>
    </div>
  </div>

</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DONN√âES ATP (via API RapidAPI / TennisApi)
// Remplace YOUR_RAPIDAPI_KEY par ta cl√© RapidAPI
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const RAPIDAPI_KEY = 'YOUR_RAPIDAPI_KEY'; // üëà √Ä remplacer

// Donn√©es de fallback r√©alistes (utilis√©es si pas de cl√© API)
const FALLBACK_PLAYERS = [
  {rank:1,name:"Jannik Sinner",country:"Italie",flag:"üáÆüáπ",points:11330,age:23,hard:95,clay:82,grass:78,winRate:87,titles2024:6,h2hWins:{}},
  {rank:2,name:"Carlos Alcaraz",country:"Espagne",flag:"üá™üá∏",points:9255,age:21,hard:88,clay:96,grass:91,winRate:84,titles2024:4,h2hWins:{}},
  {rank:3,name:"Alexander Zverev",country:"Allemagne",flag:"üá©üá™",points:7860,age:27,hard:85,clay:88,grass:72,winRate:80,titles2024:3,h2hWins:{}},
  {rank:4,name:"Taylor Fritz",country:"√âtats-Unis",flag:"üá∫üá∏",points:5360,age:26,hard:88,clay:68,grass:78,winRate:72,titles2024:2,h2hWins:{}},
  {rank:5,name:"Casper Ruud",country:"Norv√®ge",flag:"üá≥üá¥",points:4725,age:25,hard:74,clay:92,grass:65,winRate:70,titles2024:2,h2hWins:{}},
  {rank:6,name:"Novak Djokovic",country:"Serbie",flag:"üá∑üá∏",points:4595,age:37,hard:92,clay:90,grass:95,winRate:78,titles2024:1,h2hWins:{}},
  {rank:7,name:"Andrey Rublev",country:"Russie",flag:"üá∑üá∫",points:4460,age:26,hard:82,clay:80,grass:68,winRate:71,titles2024:2,h2hWins:{}},
  {rank:8,name:"Tommy Paul",country:"√âtats-Unis",flag:"üá∫üá∏",points:3930,age:27,hard:85,clay:72,grass:74,winRate:70,titles2024:1,h2hWins:{}},
  {rank:9,name:"Alex de Minaur",country:"Australie",flag:"üá¶üá∫",points:3670,age:25,hard:82,clay:74,grass:80,winRate:72,titles2024:2,h2hWins:{}},
  {rank:10,name:"Stefanos Tsitsipas",country:"Gr√®ce",flag:"üá¨üá∑",points:3465,age:26,hard:80,clay:88,grass:70,winRate:68,titles2024:1,h2hWins:{}},
  {rank:11,name:"Daniil Medvedev",country:"Russie",flag:"üá∑üá∫",points:3340,age:28,hard:90,clay:70,grass:72,winRate:74,titles2024:1,h2hWins:{}},
  {rank:12,name:"Grigor Dimitrov",country:"Bulgarie",flag:"üáßüá¨",points:3210,age:33,hard:82,clay:74,grass:80,winRate:68,titles2024:1,h2hWins:{}},
  {rank:13,name:"Holger Rune",country:"Danemark",flag:"üá©üá∞",points:2855,age:21,hard:78,clay:84,grass:72,winRate:66,titles2024:1,h2hWins:{}},
  {rank:14,name:"Ben Shelton",country:"√âtats-Unis",flag:"üá∫üá∏",points:2780,age:22,hard:82,clay:62,grass:74,winRate:65,titles2024:1,h2hWins:{}},
  {rank:15,name:"Frances Tiafoe",country:"√âtats-Unis",flag:"üá∫üá∏",points:2645,age:26,hard:78,clay:68,grass:70,winRate:64,titles2024:0,h2hWins:{}},
  {rank:16,name:"Hubert Hurkacz",country:"Pologne",flag:"üáµüá±",points:2580,age:27,hard:84,clay:70,grass:88,winRate:67,titles2024:2,h2hWins:{}},
  {rank:17,name:"Lorenzo Musetti",country:"Italie",flag:"üáÆüáπ",points:2440,age:22,hard:72,clay:82,grass:74,winRate:65,titles2024:1,h2hWins:{}},
  {rank:18,name:"Sebastian Baez",country:"Argentine",flag:"üá¶üá∑",points:2310,age:23,hard:68,clay:86,grass:58,winRate:64,titles2024:1,h2hWins:{}},
  {rank:19,name:"Ugo Humbert",country:"France",flag:"üá´üá∑",points:2260,age:26,hard:78,clay:74,grass:76,winRate:66,titles2024:2,h2hWins:{}},
  {rank:20,name:"Jack Draper",country:"Grande-Bretagne",flag:"üá¨üáß",points:2180,age:23,hard:80,clay:68,grass:82,winRate:63,titles2024:1,h2hWins:{}},
];

let allPlayers = [];
let filteredPlayers = [];
let selectedA = null;
let selectedB = null;
let currentSurface = 'all';

// ‚ïê‚ïê‚ïê‚ïê FETCH API ‚ïê‚ïê‚ïê‚ïê
async function fetchRankings() {
  try {
    const response = await fetch(
      'https://tennisapi1.p.rapidapi.com/api/tennis/rankings/atp',
      {
        headers: {
          'x-rapidapi-host': 'tennisapi1.p.rapidapi.com',
          'x-rapidapi-key': RAPIDAPI_KEY
        }
      }
    );
    if (!response.ok) throw new Error('API error');
    const data = await response.json();
    // Transformer les donn√©es API en notre format
    return data.rankings.map((p,i) => ({
      rank: p.ranking,
      name: p.rowName,
      country: p.team?.name || '‚Äî',
      flag: 'üéæ',
      points: p.points,
      age: p.team?.playerTeamInfo?.age || 0,
      hard: 75 + Math.floor(Math.random()*20),
      clay: 70 + Math.floor(Math.random()*25),
      grass: 65 + Math.floor(Math.random()*25),
      winRate: 60 + Math.floor(Math.random()*25),
      titles2024: Math.floor(Math.random()*4),
      h2hWins: {}
    }));
  } catch(e) {
    console.log('Utilisation des donn√©es de fallback:', e.message);
    return FALLBACK_PLAYERS;
  }
}

// ‚ïê‚ïê‚ïê‚ïê RENDER ‚ïê‚ïê‚ïê‚ïê
function renderRankings(players) {
  const list = document.getElementById('rankingsList');
  if (!players.length) {
    list.innerHTML = '<div style="padding:30px;text-align:center;color:var(--muted)">Aucun joueur trouv√©</div>';
    return;
  }

  list.innerHTML = players.map(p => {
    const isA = selectedA?.rank === p.rank;
    const isB = selectedB?.rank === p.rank;
    const rowClass = isA || isB ? 'player-row selected' : 'player-row';
    const btnAClass = 'compare-btn' + (isA ? ' selected-a' : '');
    const btnBClass = 'compare-btn' + (isB ? ' selected-b' : '');
    const rankClass = p.rank <= 3 ? 'rank-num top3' : 'rank-num';
    const pts = p.points.toLocaleString('fr-FR');

    // Points selon surface
    let surfaceVal = p.points;
    if(currentSurface === 'hard') surfaceVal = Math.round(p.points * p.hard / 100);
    else if(currentSurface === 'clay') surfaceVal = Math.round(p.points * p.clay / 100);
    else if(currentSurface === 'grass') surfaceVal = Math.round(p.points * p.grass / 100);

    return `
      <div class="${rowClass}" id="row-${p.rank}">
        <div class="${rankClass}">${p.rank}</div>
        <div class="player-info">
          <span class="player-flag">${p.flag}</span>
          <div>
            <div class="player-name">${p.name}</div>
            <div class="player-country">${p.country}</div>
          </div>
        </div>
        <div>
          <div class="player-points">${surfaceVal.toLocaleString('fr-FR')}</div>
          <div class="player-pts-label">points</div>
        </div>
        <div style="display:flex;flex-direction:column;gap:4px">
          <button class="${btnAClass}" onclick='selectPlayer(${JSON.stringify(p)}, "A")'>A</button>
          <button class="${btnBClass}" onclick='selectPlayer(${JSON.stringify(p)}, "B")'>B</button>
        </div>
      </div>
    `;
  }).join('');
}

// ‚ïê‚ïê‚ïê‚ïê SELECTION ‚ïê‚ïê‚ïê‚ïê
function selectPlayer(player, slot) {
  if (slot === 'A') {
    if (selectedB?.rank === player.rank) return; // m√™me joueur
    selectedA = player;
    const slotEl = document.getElementById('slotA');
    slotEl.className = 'slot filled-a';
    slotEl.innerHTML = `
      <div class="slot-label" style="color:var(--accent)">Joueur A</div>
      <div class="slot-flag">${player.flag}</div>
      <div class="slot-name" style="color:var(--accent)">${player.name.split(' ').pop()}</div>
      <div class="slot-rank">#${player.rank} ¬∑ ${player.points.toLocaleString('fr-FR')} pts</div>
    `;
  } else {
    if (selectedA?.rank === player.rank) return;
    selectedB = player;
    const slotEl = document.getElementById('slotB');
    slotEl.className = 'slot filled-b';
    slotEl.innerHTML = `
      <div class="slot-label" style="color:var(--accent2)">Joueur B</div>
      <div class="slot-flag">${player.flag}</div>
      <div class="slot-name" style="color:var(--accent2)">${player.name.split(' ').pop()}</div>
      <div class="slot-rank">#${player.rank} ¬∑ ${player.points.toLocaleString('fr-FR')} pts</div>
    `;
  }

  const btn = document.getElementById('compareBtn');
  btn.disabled = !(selectedA && selectedB);
  document.getElementById('algoResult').innerHTML = `
    <div class="algo-placeholder"><div class="icon">‚ö°</div>Clique "Lancer l'algorithme"</div>`;

  renderRankings(filteredPlayers);
}

// ‚ïê‚ïê‚ïê‚ïê ALGORITHME DE COMPARAISON ‚ïê‚ïê‚ïê‚ïê
function runAlgo() {
  const A = selectedA;
  const B = selectedB;

  // Scores par crit√®re (sur 100)
  const criteria = [
    {
      name: "Classement ATP",
      icon: "üèÜ",
      scoreA: Math.round(100 - (A.rank / 100) * 60),
      scoreB: Math.round(100 - (B.rank / 100) * 60),
      weight: 0.30
    },
    {
      name: "Surface (Hard)",
      icon: "üéæ",
      scoreA: A.hard,
      scoreB: B.hard,
      weight: 0.20
    },
    {
      name: "Forme r√©cente",
      icon: "üî•",
      scoreA: A.winRate,
      scoreB: B.winRate,
      weight: 0.25
    },
    {
      name: "Points / Momentum",
      icon: "üìà",
      scoreA: Math.round((A.points / Math.max(A.points,B.points)) * 100),
      scoreB: Math.round((B.points / Math.max(A.points,B.points)) * 100),
      weight: 0.15
    },
    {
      name: "Titres 2024",
      icon: "ü•á",
      scoreA: A.titles2024 === 0 && B.titles2024 === 0 ? 50 : Math.round((A.titles2024 / Math.max(A.titles2024+B.titles2024, 1)) * 100),
      scoreB: A.titles2024 === 0 && B.titles2024 === 0 ? 50 : Math.round((B.titles2024 / Math.max(A.titles2024+B.titles2024, 1)) * 100),
      weight: 0.10
    }
  ];

  // Score global pond√©r√©
  let globalA = 0, globalB = 0;
  criteria.forEach(c => {
    globalA += c.scoreA * c.weight;
    globalB += c.scoreB * c.weight;
  });
  const total = globalA + globalB;
  const probA = Math.round((globalA / total) * 100);
  const probB = 100 - probA;

  const winner = globalA > globalB ? A : B;
  const winnerColor = globalA > globalB ? 'var(--accent)' : 'var(--accent2)';

  // Render
  const html = `
    <!-- Barre globale -->
    <div class="algo-score-bar">
      <div class="algo-players">
        <span class="algo-player-label a">${A.name.split(' ').pop()} ${probA}%</span>
        <span class="algo-player-label b">${probB}% ${B.name.split(' ').pop()}</span>
      </div>
      <div class="bar-container">
        <div class="bar-fill a" style="width:${probA}%"></div>
        <div class="bar-fill b" style="width:${probB}%"></div>
      </div>
    </div>

    <!-- Crit√®res -->
    <div class="algo-categories">
      ${criteria.map(c => {
        const t = c.scoreA + c.scoreB;
        const pA = Math.round((c.scoreA / t) * 100);
        const pB = 100 - pA;
        const diff = c.scoreA - c.scoreB;
        let winnerBadge = diff > 3 ? `<span class="algo-cat-winner a">${A.name.split(' ').pop()}</span>`
                        : diff < -3 ? `<span class="algo-cat-winner b">${B.name.split(' ').pop()}</span>`
                        : `<span class="algo-cat-winner tie">√âgalit√©</span>`;
        return `
          <div class="algo-cat">
            <div class="algo-cat-header">
              <span class="algo-cat-name">${c.icon} ${c.name}</span>
              ${winnerBadge}
            </div>
            <div class="mini-bar">
              <div class="mini-fill-a" style="width:${pA}%"></div>
              <div class="mini-fill-b" style="width:${pB}%"></div>
            </div>
            <div class="algo-values">
              <span class="algo-val a">${c.scoreA}</span>
              <span class="algo-val b">${c.scoreB}</span>
            </div>
          </div>
        `;
      }).join('')}
    </div>

    <!-- Verdict -->
    <div class="verdict">
      <div class="verdict-label">Favori selon l'algorithme</div>
      <div class="verdict-winner" style="color:${winnerColor}">${winner.flag} ${winner.name}</div>
      <div class="verdict-prob">Probabilit√© de victoire estim√©e : <strong style="color:${winnerColor}">${Math.max(probA,probB)}%</strong></div>
    </div>
  `;

  document.getElementById('algoResult').innerHTML = html;
}

// ‚ïê‚ïê‚ïê‚ïê FILTRES ‚ïê‚ïê‚ïê‚ïê
function filterPlayers(query) {
  filteredPlayers = allPlayers.filter(p =>
    p.name.toLowerCase().includes(query.toLowerCase()) ||
    p.country.toLowerCase().includes(query.toLowerCase())
  );
  renderRankings(filteredPlayers);
}

function filterSurface(surface, btn) {
  currentSurface = surface;
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  btn.classList.add('active');
  renderRankings(filteredPlayers);
}

// ‚ïê‚ïê‚ïê‚ïê INIT ‚ïê‚ïê‚ïê‚ïê
async function init() {
  allPlayers = await fetchRankings();
  filteredPlayers = [...allPlayers];
  renderRankings(filteredPlayers);
  document.getElementById('updateTime').textContent = new Date().toLocaleString('fr-FR');
}

init();
</script>
</body>
</html>
